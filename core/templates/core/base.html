{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}CycleSyNCðŸ«§{% endblock %}</title>
    <link rel="icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"
      integrity="sha512-7VZt+3gJt6FjC03Tvpc4tpDqFQZoEFR+FlH9mt2zhYdiuS0HfM5woIhV4x3JiJf7ka1O77Ih/I7ReO1r5XFPmw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <style>
      #logo {
        display: inline-block;
        font-size: clamp(1.5rem, 5vw, 2rem); /* Responsive font size */
        color: #ff69b4;
      }
      :root {
        --bg-start: #ffe6f0;
        --bg-end: #ffffff;
        --bg-angle: 145deg;
        --shadow-light: rgba(255, 255, 255, 0.7);
        --shadow-dark: rgba(0, 0, 0, 0.15);
        --accent: rgba(255, 105, 180, 0.2);
      }
      .neumo-heading {
        text-align: center;
        margin-bottom: 1.5rem;
        color: #333;
        text-shadow: 1px 1px 2px var(--shadow-light);
        font-size: clamp(1.25rem, 4vw, 1.5rem); /* Responsive heading */
      }
      body {
        background: linear-gradient(var(--bg-angle), var(--bg-start), var(--bg-end));
        font-family: sans-serif;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        font-size: clamp(14px, 3.5vw, 16px); /* Base font size */
      }
      header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background-color: white;
        padding: clamp(8px, 2vw, 12px) clamp(12px, 3vw, 16px); /* Responsive padding */
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        z-index: 1000;
      }
      nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #f8f9fa;
        padding: clamp(0.5rem, 2vw, 0.75rem);
      }
      .nav-links {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: clamp(0.5rem, 2vw, 1rem);
        flex-grow: 1;
      }
      .menu-icon {
        display: none;
        font-size: clamp(20px, 5vw, 24px);
        cursor: pointer;
        padding: 0.5rem;
      }
      nav a {
        text-decoration: none;
        color: #333;
        font-weight: bold;
        padding: clamp(0.3rem, 1vw, 0.5rem);
        display: flex;
        align-items: center;
        gap: 0.5rem; /* Space between icon and text */
      }
      nav a:hover {
        color: #ff69b4;
        transform: none; /* Disable scale on hover for mobile */
        transition: color 0.3s ease;
      }
      main {
        margin-top: calc(60px + 2rem); /* Dynamic margin based on header height */
        padding: clamp(1rem, 3vw, 1.5rem);
        flex: 1; /* Allow main to grow */
      }
      .alert-success {
        background-color: #d4edda;
        color: #155724;
        padding: 0.75rem 1rem;
        border-radius: 0.25rem;
        margin-bottom: 1rem;
        font-size: clamp(12px, 3vw, 14px);
      }
      .alert-danger {
        background-color: #f8d7da;
        color: #721c24;
        padding: 0.75rem 1rem;
        border-radius: 0.25rem;
        margin-bottom: 1rem;
        font-size: clamp(12px, 3vw, 14px);
      }
      .mess {
        position: fixed;
        top: calc(60px + 0.5rem); /* Position below header */
        left: 0;
        right: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1100; /* Above header */
        padding: 0 clamp(0.5rem, 2vw, 1rem);
      }
      .profile-img {
        width: clamp(30px, 8vw, 40px);
        height: clamp(30px, 8vw, 40px);
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #ffffff;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      }
      /* Mobile Navigation */
      @media (max-width: 768px) {
        .nav-links {
          display: none;
          flex-direction: column;
          position: fixed;
          top: 60px; /* Match header height */
          left: 0;
          right: 0;
          background-color: #f8f9fa;
          padding: 1rem;
          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
          z-index: 1000;
        }
        .nav-links.active {
          display: flex;
        }
        .nav-links a {
          padding: 0.75rem;
          width: 100%;
          text-align: center;
          font-size: clamp(14px, 4vw, 16px);
        }
        .menu-icon {
          display: block;
        }
        nav {
          padding: 0.5rem;
        }
      }
      /* Small Screens */
      @media (max-width: 480px) {
        header {
          padding: 8px 10px;
        }
        main {
          padding: 0.75rem;
        }
        .mess {
          top: calc(50px + 0.5rem); /* Adjust for smaller header */
        }
      }
      /* Disable hover effects on touch devices */
      @media (hover: none) {
        nav a:hover {
          transform: none;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        {% if user.is_authenticated %}
        <a href="{% url 'dashboard' %}">
          <span id="logo"><b>C</b>ycle<b>S</b>y<i>NC</i> <sup>ðŸ«§</sup></span>
        </a>
        <div class="nav-links">
          <a href="{% url 'dashboard' %}"><img src="{% static 'img/home.svg' %}" alt="home" style="width:24px; height:24px;" /> Home</a>
          <a href="{% url 'profile' %}">
            <img src="{{ request.user.profile.profile_image.url }}" alt="profile" class="profile-img" />
            <sup style="color:#ff69b4;">{{request.user.username}}</sup>
          </a>
          <a href="{% url 'calendar' %}"><img src="{% static 'img/calendar-clock.svg' %}" alt="calendar" style="width:24px; height:24px;" /> Calendar</a>
          <a href="{% url 'daily_log' %}">Logs</a>
          <a href="#">Read</a>
          <a href="{% url 'logout' %}"><img src="{% static 'img/logout.svg' %}" alt="logout" style="width:24px; height:24px;" /> Logout</a>
        </div>
        <span class="menu-icon">â˜°</span>
        {% endif %}
      </nav>
      <div class="mess">
        {% if messages %}
        <div class="messages">
          {% for msg in messages %}
          <div class="alert {% if msg.tags == 'success' %}alert-success{% else %}alert-danger{% endif %}" role="alert">
            {{ msg }}
          </div>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </header>
    <main>{% block content %}{% endblock %}</main>
    <script defer>
      document.addEventListener("DOMContentLoaded", function () {
        // Logo animation
        anime({
          targets: "#logo",
          translateY: [
            { value: -10, duration: 600 },
            { value: 0, duration: 600 },
          ],
          scale: [
            { value: 1.1, duration: 600, easing: "easeOutQuad" },
            { value: 1, duration: 600, easing: "easeInQuad" },
          ],
          loop: true,
          delay: 500,
        });

        // Menu toggle
        const menuIcon = document.querySelector(".menu-icon");
        const navLinks = document.querySelector(".nav-links");
        if (menuIcon && navLinks) {
          menuIcon.addEventListener("click", function () {
            navLinks.classList.toggle("active");
          });

          // Close menu when clicking a link
          navLinks.querySelectorAll("a").forEach((link) =>
            link.addEventListener("click", () => {
              navLinks.classList.remove("active");
            })
          );

          // Close menu when clicking outside
          document.addEventListener("click", function (e) {
            if (!navLinks.contains(e.target) && !menuIcon.contains(e.target)) {
              navLinks.classList.remove("active");
            }
          });
        }
      });
    </script>
  </body>
</html>